%%%%%%%%%%%%%%%%%%%%%%% file template.tex %%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First comes an example EPS file -- just ignore it and
% proceed on the \documentclass line
% your LaTeX will extract the file if required
\begin{filecontents*}{example.eps}
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 19 19 221 221
%%CreationDate: Mon Sep 29 1997
%%Creator: programmed by hand (JK)
%%EndComments
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
\documentclass[smallextended]{svjour3}       % onecolumn (second format)
%\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
%
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%
\begin{document}

\title{Integrating and validating urban simulation models}
\subtitle{}

%\titlerunning{Short form of title}        % if too long for running head

\author{Juste Raimbault}

%\authorrunning{Short form of author list} % if too long for running head

\institute{J. Raimbault \at
              Center for Advanced Spatial Analysis, University College London\\
              \email{j.raimbault@ucl.ac.uk}
}

%\date{Received: date / Accepted: date}
\date{}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
\vspace{-1cm}
Urban systems are intrinsically complex, involving different dimensions and scales, and consequently various approaches and scientific disciplines. In that context, urban simulation models have been coined as essential for the construction of evidence-based and integrated urban sciences. This review and position paper synthesises previous work focused on coupling and integrating urban models on the one hand, and exploring and validating such simulation models on the other hand. These research directions are complementary basis for a research program towards the development of integrated urban theories, with some application perspectives to sustainable territorial planning.
\keywords{Urban simulation models \and Model coupling \and Model validation \and Sustainable territorial policies}
\end{abstract}


\section{Introduction}


Cities, and more generally urban and territorial systems, are highly complex to understand, manage and plan. They imply imbricated scales, from the intra-urban microscopic scales with individual agents such as household or companies, through the intermediate mesoscopic scale of the urban area, to the macroscopic scale of systems of cities \cite{pumain2008socio}. Many different dimensions and viewpoints can be considered as an entry into urban issues, and several disciplines relate to emerging urban sciences \cite{batty2013new}, including urban economics, urban geography, planning and design. Complexity approaches to cities are therefore a relevant interdisciplinary take into urban systems \cite{batty2012origins}.

Furthermore, the question of sustainable cities and territories is crucial in terms of policy application of urban sciences, especially in the current context of global change and pressing need for sustainable transitions. Cities can be in that context as much an issue than a solution, and models with sufficient endogeneity can help to anticipate their dynamics. The integration of environmental dimensions within simulation models for territorial systems is in that context an important aspect, but the coupling between dimensions remains generally weak or to a certain level of exogeneity. For example, \cite{viguie2014downscaling} use an urban growth model to evaluate the local impact of climate change, but does not make associated aspects endogenous, such as energy price or the energy efficiency of the urban structure. Negative externalities such as congestion and pollution, directly linked to emissions, have a feedback for example on the location of activities. Similarly, numerous studies in ecology which establish the impact of anthropic habitat disturbances would particularly benefit from a coupling with urban growth models, for example for a better management of the interface between the city and nature within the new urban regimes that are urban mega-regions \cite{hall2006polycentric}. At the macroscopic scale, several couplings between models of systems of cities and ecological models or from environmental science can also be considered. For example issues related to the production, storage and distribution of energy are endogenous to territorial systems, and the dynamics of infrastructures and associated entities can be integrated within models for systems of cities \cite{pumain2018evolutionary}.


In that context, we propose a research program rooted into complexity science to foster the construction of bridges and interdisciplinary dialogues in urban science, in some sense the construction of integrated urban theories. The concept of integration can be understood through the complex systems roadmap \cite{bourgine2009french}. It combines horizontal integration (fundamental transversal questions at the intersection of different types of complex systems) with vertical integration (multiple levels coupled within multi-scale models). The integration between knowledge domains in the sense of \cite{raimbault2017applied}, (theoretical, empirical, modeling, data, methods and tools knowledge domains) is also an aspect of the expected integration, especially through the strong link between models, empirical data and methods, with their exploration and validation.

We indeed directly inherit from the evolutionary theory of cities developed by Denise Pumain \cite{pumain2017urban}, in particular regarding the role of simulation models and model validation methods - the OpenMOLE platform and associated methods \cite{reuillon2013openmole} were mainly developed in this frame. We assume thus that the construction of integrated models can not be achieved independently from their systematic exploration and validation. The project is thus built on three complementary axis: (i) the coupling of heterogenous urban models to integrate dimensions; (ii) the coupling of models at different scales for the vertical integration; and (iii) the development of new spatial simulation model validation methods, simultaneously applied to previous models.

The integration of urban models has a long history linked to the development of quantitative approaches to urban systems and operational urban models \cite{batty2021defining}. Land-use Transport Interaction models for example, which aim at simulating the impact of transportation infrastructure on different components of territories, generally include several sub-models such as transport models, cellular automatons for the evolution of land-use, or economic microsimulation models \cite{wegener2021land}. The framework proposed by \cite{batty2021new} implements spatial interaction modeling between population and employment on large-scale urban system, providing a basis for coupling with other dimensions and other types of models. More recently, the development of integrated models for smart cities has also put forward the relevance of model coupling in urban simulation. \cite{yamagata2013simulating} couple for example models for land-use and energy consumption. \cite{muvuna2019methodology} introduce a framework to integrate information from different components of the smart city.

The question of integrating models and dimensions has also been the focus of other disciplines not directly related to urban issues. Ecology has for example studied the interaction between society, ecosystems and resources \cite{bithell2009coupling}. The link between economics and ecology is a crucial issue regarding sustainability \cite{hofkes1996modelling}. Resource economics is a field in which model coupling can act as a medium for smoother interdisciplinary collaborations \cite{macleod2016model}. Within urban science, such research directions remain mostly to be explored, from diverse viewpoints including methodology and theory.


We describe each axis of our research program in the rest of this paper, mostly by developing a synthesis of previous research at the basis of this project. We finally discuss how the construction of such integrated models could be applied to the design of sustainable territorial planning policies.


\section{Horizontal integration: coupling urban models and dimensions}


\subsection{Model coupling}

An horizontal integration between complementary dimensions of urban systems can be achieved through the coupling of different urban models, taking into account different dimensions. The example of urban dynamics and environmental issues developed above can be investigated regarding several issues related to climate change, such as flooding \cite{ford2019multi} or heat waves \cite{lemonsu2015vulnerability}. The integration of economy and geography is also a question that remains to be mostly explored \cite{marchionni2004geographical}. More generally, the Sustainable Development Goals are declined into 17 goals and 169 targets which must be tackled in an integrative way \cite{stafford2017integration}.

Some previous work, building on the evolutionary theory of cities and at the inception of this project, focuses on the co-evolution of transportation networks and territories. It illustrates how such model coupling can be achieved. \cite{raimbault2019urban} couples a reaction-diffusion urban morphogenesis model with a multi-model of transportation network growth to yield a co-evolution model at the mesoscopic scale. At the scale of the system of cities, \cite{raimbault2021modeling} integrates an abstract urban network evolution model into an urban dynamics model for the population of cities. These models effectively achieve a strong coupling, as they capture circular causality between the transportation network and cities \cite{raimbault2020unveiling}. A refinement of the network growth heuristic for the macro model, described by \cite{raimbault2020hierarchy}, introduces an intermediate scale of geographical description, and is a first step towards multi-scale models.

Current work recently presented as \cite{raimbault2021estimating} and based on the methodology of \cite{raimbault2021building} focuses on coupling models to build open transport models from the bottom-up using open source components: the Matsim transport modeling framework \cite{horni2016multi} is for example integrated with the Quant spatial interaction model \cite{batty2021new} and a population microsimulation model \cite{lomax2017microsimulation}. The implementation of model coupling using the OpenMOLE workflow system \cite{passerat2017reproducible} illustrates the joint development and exploration of models. Expected policy results of this work integrate an additional dimension, through the implementation of density indicators in public transport which can be used as a proxy for potential contamination in the epidemiological context of COVID-19.



\subsection{Literature mapping}

Model coupling between disciplines is made simpler when a reflexive positioning is available, for example using scientometrics and literature mapping techniques. Therefore, \cite{raimbault2019exploration} provides a framework to jointly explore interdisciplinary citation and semantic networks, while \cite{raimbault2021empowering} develop open tools to explore scientific corpuses. 

Literature mapping and systematic reviews can also be used to identify and compare existing models with great detail, as for the case of land-use transport interactions: \cite{raimbault2021interdisciplinary} proposes a map of the interactions between disciplines involved in such modeling (from geography to urban economics, planning and physics) while \cite{raimbault2019meta} proceeds to a meta-analysis of model characteristics based on their scientific context. Such efforts can also be a basis towards more advanced model benchmarking experiments, as \cite{raimbault2020comparison} in the case of several urban morphogenesis models in terms of produced urban morphologies; these benchmark being in turn a step towards model integration or multi-modeling approaches.

\subsection{Open issues}

% weak-strong coupling
% semantic coupling of existing models

%  the famous “scaling challenge” (or “dimensional malediction” and other names). When the studied system becomes huge and highly complex, how to manage efficiently the model representing it? Is there a simple way to proceed? In our case of ecosystem functioning, we chose to work with qualitative variables (possibly not far from the “stylized dynamics”, mentioned yet not explained by the author). Here, we have no idea whether this relevant wish to integrate will remain feasible. A logical corollary follows in the challenge to manage time in such complicated models or, more generally, how to couple models for building a larger, more complex and more integrated one. In term of time management, in particular between various models coupled, I would have wished cited the DEVS framework or some attempts related to synchronous/asynchronous modes in computer sciences.

% no discussion is provided about the dimension compatibility and commensurability. Is it always possible to integrate the various disciplines and knowledge/skills involved in urban systems (for example, it is not at all obvious on how to couple human and non-human processes into the same model)? How to proceed, if not? I guess that many references could be cited in such a discussion. Also, I recognize many working stages close to what has been already tried in the past in landscape ecology (for example, the neutral landscape models).


\section{Vertical integration: constructing multi-scale models}


The construction of multi-scale models is in itself a crucial aspect towards integrated models and theories. Following \cite{rozenblat2018conclusion}, systems of cities have reached multiple levels of articulation and interdependencies. This implies that their management and planning must necessarily be multi-scalar in order to take into account geographical particularities, while still ensuring a global consistence which is a condition for limited inequalities between territories.


Moreover, considerable methodological work is required to elaborate coupling methods between scales, as for example the hybrid modeling coupling agent-based models with differential equations for an epidemiological model \cite{banos2015coupling}. This allows determining the relevance of levels to be included for tackling a particular problem and avoid so-called ontological dead-ends (i.e. include appropriate levels of representation) \cite{roth2006reconstruction}. Such methodological investigation are also necessary to understand the nature of retroactions between scales to be included, and when these are necessary or not. A crucial aspect mostly neglected in the literature is to effectively achieve a strong coupling between scales, in the sense of including both upward and downward feedbacks.

Recent work paved the way towards such multi-scale strongly coupled models. \cite{raimbault2021strong} couples the urban dynamics model of \cite{raimbault2020indirect} at the scale of the system of cities with the urban morphogenesis model of \cite{raimbault2018calibration} at the scale of the urban area. Downward feedback is captured through policy parameters, as local development decisions generally react to the global integration of a given city, while upward feedback is taken into account by combining positive and negative externalities within the urban area to update its global performance and interaction parameters with other cities.

To understand the interplay between urban form at the microscopic scale, transportation network development and developer agents decisions at the mesoscopic scale, \cite{raimbault2021multiscale} proposes a stylised agent-based model achieving a strong coupling between the microscopic and mesoscopic scale.

These efforts remain at the stage of stylised and rather simple model, and the construction of data-driven and validated multi-scale models remains to be explored. Coupling between scales is also a way to couple between different urban dimensions, and both integration are not necessarily independent.


\section{Model exploration and validation}



\subsection{}

Working to integrate models and theories necessarily implies a better understanding of the modeling process itself, but also of stylised dynamics produced by simulation models. % todo def stylised

In the case of geographical models for urban systems, such a knowledge has for example been developed within the \emph{Geodivercity} European Research Council project lead by Denise Pumain \cite{pumain2017urban}, which included to the conception of new model validation methods. These methods were elaborated specifically to tackle thematic geographical questions, but were applied to many contexts thereafter, witnessing a beneficial relationship both from the geography and computer science viewpoints \cite{raimbault2019methods}. More generally in social sciences, modeling and simulation driven by new practices including model coupling, the use of high-performance computing for model exploration, and open science practices, are tightly linked to the production of a new type of integrated knowledge \cite{banos2013pour}. This is in some sense an aspect of the computational shift in contemporary science coined by \cite{arthur2014complexity}.


Such model validation methods can be applied for example to assess the necessity and sufficiency of processes in a multi-modeling context, in the case of the Calibration Profile algorithm \cite{reuillon2015new}. Genetic algorithms distributed on a computation grid using OpenMOLE are a highly efficient tool for model calibration \cite{schmitt2015half}. The search for diversity in model outputs, obtained with the Pattern Space Exploration algorithm, can be used to explore the space of feasible configurations a model can produce, and possibly highlight unexpected behavior \cite{cherel2015beyond}.


Therefore, the development of specific methods and tools to improve the extraction of knowledge from simulation models, and an epistemological investigation on modeling practices, are crucial within this project. Methods for the exploration, sensitivity analysis, and validation, are essential for robust application of models, but also yield a better complementarity with other types of approaches since they can establish when modeling is not relevant anymore.


\subsection{Spatial sensitivity analysis}

Recent work has focused on the development of validation methods in the specific case of spatial simulation models. More particularly, a methodology coined as \emph{Spatial Sensitivity Analysis} has been introduced by \cite{raimbault2019space} in order to understand the effect of spatial initial conditions on model outcomes. This provides a generic way to disentangle effects which are intrinsic to model dynamics from contingent effects due to the geography. The generation of synthetic spatial configuration for territorial systems is required, and \cite{raimbault2019second} has investigated the generation of such data while controlling correlation patterns. \cite{raimbault2019generating} introduce and compare multiple generators for building configurations at the district scale. These methods are implemented into a single scala library, allowing an easier integration into the OpenMOLE software \cite{raimbault2020scala}.

\subsection{}

% What kind of calibration/validation stages does the author have in mind? What is required (data, algorithms, etc.) and what should be avoided? For example, a short discussion about traditional or more elaborated MCMC/particle filtering would be relevant (and should be cited).

%  I noticed conceptual issues, such as the challenge of using tractable models. If the author and his team plan to use simulations only (and avoid analytical results), how can we be sure that computed dynamics will be robust. Some scientists have decided to avoid statistical models and, say, individual-based models (IBMs) to avoid such a simulation bias. In ecology for example, we decided to work with discrete models and keep fully tractable (analytical) dynamics.


\section{Discussion: towards evidence-based multi-scalar sustainable territorial planning}

% why building integrated models (that are still models), who are the users

%Considering modeling as a crucial element of knowledge production, this project is thus situated within approaches in theoretical and quantitative geography \citep{cuyala2014analyse} and geosimulation \citep{benenson2004geosimulation} in the case of simulation models. 
% => model functions

The strong complementarity of the three axis of the research program, elaborated on previous and current work described above, stems naturally from the intrinsic link between vertical and horizontal integrations, and from the integration of knowledge domains as model validation methods are elaborated jointly as models are constructed and explored. A fully open issue is the transfer of integrated models towards policy applications.


A first research direction lies in the modeling of policy and governance itself. The management of sustainability implies according to \cite{etzion2018management} new governance structures. Their modeling is still not well integrated within spatially explicit models. \cite{le2015modeling} has proposed to integrate transportation network governance into a land-use transport model to yield a co-evolution model. \cite{raimbault2020coevolution} uses game-theory to simulate transportation network investments at the scale of the system of cities.


One other crucial research axis towards the application of integrated models to policies is the construction of harmonised multi-dimensional databases. Such databases must (i) consider consistent geographical entities in time, in the sense of the dynamical ontology proposed by \cite{bretagnolle2009villes}; (ii) integrate multiple dimensions to allow coupling urban dynamics with socio-economic, environmental, sustainability and global change issues; (iii) be open, accessible, documented and reproducible.
% the data part is not so much developed in the project (one paragraph at the end), no mention of digital twin for cities or of Cities Information Modelling

Finally, models must be constructed with their application context to ensure their potential applicability. Many different paths can be taken for such a co-construction, such as companion modeling \cite{drogoul2015agent} in which local stakeholders participate to the construction and exploration of the model. Issues related to real-time model visualisation are also an important problem to take into account for model applications \cite{milton2019accelerating}. Scientific mediation initiatives are an other way to diffuse the results of modeling experiments into policy applications.



\section{Conclusion}

The diversity and complexity of urban systems requires a plurality of viewpoints \cite{pumain2020conclusion}, which call for integration between dimensions and scales. We have synthesised in this paper a current stream of research focusing around three axis, namely (i) horizontal integration through model coupling; (ii) vertical integration through the construction of multi-scale urban models; and (iii) development of model validation and exploration methods. These strongly complementary axis form the basis of a long term research program, with a goal of application to sustainable territorial policies.


% BibTeX users please use one of
\bibliographystyle{unsrt}
%\bibliographystyle{spbasic}      % basic style, author-year citations
%\bibliographystyle{spmpsci}      % mathematics and physical sciences
%\bibliographystyle{spphys}       % APS-like style for physics
\bibliography{biblio.bib}   % name your BibTeX data base


\end{document}
% end of file template.tex


%
%% For one-column wide figures use
%\begin{figure}
%% Use the relevant command to insert your figure file.
%% For example, with the graphicx package use
%  \includegraphics{example.eps}
%% figure caption is below the figure
%\caption{Please write your figure caption here}
%\label{fig:1}       % Give a unique label
%\end{figure}
%%
%% For two-column wide figures use
%\begin{figure*}
%% Use the relevant command to insert your figure file.
%% For example, with the graphicx package use
%  \includegraphics[width=0.75\textwidth]{example.eps}
%% figure caption is below the figure
%\caption{Please write your figure caption here}
%\label{fig:2}       % Give a unique label
%\end{figure*}
%%
%% For tables use
%\begin{table}
%% table caption is above the table
%\caption{Please write your table caption here}
%\label{tab:1}       % Give a unique label
%% For LaTeX tables use
%\begin{tabular}{lll}
%\hline\noalign{\smallskip}
%first & second & third  \\
%\noalign{\smallskip}\hline\noalign{\smallskip}
%number & number & number \\
%number & number & number \\
%\noalign{\smallskip}\hline
%\end{tabular}
%\end{table}

