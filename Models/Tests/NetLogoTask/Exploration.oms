import java.util.Date
import java.text.SimpleDateFormat

logger.level("FINE")



val turtles = Val[Double]
val radius = Val[Double]

val randomRadiuses = Val[Array[Array[Double]]]

val density = Val[Double]

val replication = Val[Int]

val cmds = List("setup","run-experiment")

val model = NetLogo5Task(workDirectory / "randomwalk.nlogo", cmds,embedWorkspace=true,seed=replication) set(
  inputs += (turtles,radius,randomRadiuses,replication),
  outputs += (turtles,radius,replication),
  netLogoInputs += (turtles,"#-turtles"),
  netLogoInputs += (radius,"density-radius"),
  netLogoArrayInputs += (randomRadiuses,"random-radiuses"),
  netLogoOutputs += ("avg-density",density)
)

val purpose = "TEST"

val indics_hook = AppendToCSVFileHook(workDirectory / "exploration" / ((new SimpleDateFormat("yyyyMMdd_HHmmss")).format(new Date()))+"_"+purpose+".csv")

val env = LocalEnvironment(4)

val replications =
 Replication (
   evaluation = model on env,
   seed = replication,
   replications = 2
)

val exploration =
  DirectSampling(
    evaluation = replications hook indics_hook,
    sampling = LHS(
      2,
      turtles in Range(100.0,500.0),
      radius in Range(0.1,10.0)
    ) x (randomRadiuses is Array(Array(1.0,2.0),Array(5.0,10.0)))
  )


exploration
